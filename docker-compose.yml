version: "3.9"
services:
  app:
    build: ./app
    ports:
      - "3000:3000"
    environment:
      SHOPIFY_APP_URL: http://localhost:3000
    depends_on:
      - backend
  backend:
    build: ./backend
    ports:
      - "8000:8000"
    environment:
      WORKER_URL: http://worker:9000
  worker:
    build: ./worker
    ports:
      - "9000:9000"
    runtime: nvidia
    environment:
      CUDA_VISIBLE_DEVICES: "0"

# This compose file assumes that each service has its own Dockerfile in
# the corresponding directory.  The `worker` service is configured with
# `runtime: nvidia` for GPU acceleration and exposes its API on port 9000.
# Adjust ports and environment variables as needed for your setup.
